<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Learn You a Physics for Great Good!</title>
    <link rel="stylesheet" type="text/css" href="../style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  </head>

  <body>
    <header>
      <a href="../index.html"><h1>Learn You a <span class="physics">Physics</span> for Great Good!</h1></a>
      <h1>&gt;&gt;&gt; WORK IN PROGRESS &lt;&lt;&lt;</h1>
      <h2>Dimensions / Usage</h2>
      <nav>
	<span>[src: <a href="https://github.com/DSLsofMath/BScProj2018/blob/master/Physics/src/Dimensions/Usage.lhs">Dimensions/Usage.lhs</a>]</span>
        <span>Previous: <a href="../Dimensions/Testing%20of%20Quantities.html">Testing of Quantities</a></span>
        <a href="../index.html">Table of contents</a>
        <span>Next: <a href="../Newtonian%20Mechanics/Single%20particle%20mechanics.html">Single particle mechanics</a></span>
      </nav>
    </header>

    <main>
      <h1 id="usage">Usage</h1>

<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">module</span> <span class="dt">Dimensions.Usage</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">    (</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">    ) <span class="kw">where</span></a></code></pre></div>
<p>In this module we’ll show how to use value-level dimensions, type-level dimensions and <code>Quantity</code> in an “actual” progam. Let’s first use this fancy GHC-extension</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ot">{-# LANGUAGE TypeOperators #-}</span></a></code></pre></div>
<p>and then import the things we have created.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">import</span> <span class="dt">Dimensions.TypeLevel</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">import</span> <span class="dt">Dimensions.Quantity</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">import</span> <span class="dt">Prelude</span> <span class="kw">hiding</span> (length)</a></code></pre></div>
<p>We don’t need to import <code>Dimensions.ValueLevel</code> since all its features are available by using the <code>Quantity</code> data type. The same thing could be said about <code>Dimensions.TypeLevel</code>. So why do we import it? It’s so we can write explicit type signatures, the trick of trade in Haskell progamming.</p>
<h2 id="values-and-types">Values and types</h2>
<p>Let’s create a length, time and mass, in the way hinted in the previous chapter.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1">myLength <span class="fu">=</span> <span class="fl">10.0</span> <span class="fu">#</span> length</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">myTime   <span class="fu">=</span> <span class="fl">20.0</span> <span class="fu">#</span> time</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">myMass   <span class="fu">=</span> <span class="fl">30.0</span> <span class="fu">#</span> mass</a></code></pre></div>
<p>Okay, let’s check out their type and value in GHCi.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">ghci<span class="fu">&gt;</span> myLength</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="fl">10.0</span> m</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">ghci<span class="fu">&gt;</span> <span class="fu">:</span>t myLength</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="ot">myLength ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">ghci<span class="fu">&gt;</span> myTime</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="fl">20.0</span> s</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">ghci<span class="fu">&gt;</span> <span class="fu">:</span>t myTime</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="ot">myTime ::</span> <span class="dt">Quantity</span> <span class="dt">Time</span> <span class="dt">Double</span></a></code></pre></div>
<p>The pretty printing works thanks to dimensions on <em>value-level</em> and the Haskell-types thanks to the <em>type-level</em> dimensions. Recall that the value-level dimensions just is a pretty simple “average” data type.</p>
<p>Let’s write some type signatures on those values (of type <code>Quantity</code>).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ot">myLength ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">myLength <span class="fu">=</span> <span class="fl">10.0</span> <span class="fu">#</span> length</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="ot">myTime ::</span> <span class="dt">Quantity</span> <span class="dt">Time</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">myTime <span class="fu">=</span> <span class="fl">20.0</span> <span class="fu">#</span> time</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="ot">myMass ::</span> <span class="dt">Quantity</span> <span class="dt">Mass</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">myMass <span class="fu">=</span> <span class="fl">30.0</span> <span class="fu">#</span> mass</a></code></pre></div>
<p>Neat! <code>Length</code>, <code>Time</code> and <code>Mass</code> are type-level dimensions. Therefore, <code>Length</code> <em>is</em> a type, just like <code>String</code> is a type.</p>
<p>Remember that the sugary style of writing <code>10.0 # length</code> is a shorthand for doing</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ot">myLength ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">myLength <span class="fu">=</span> <span class="dt">Quantity</span> length&#39; <span class="fl">10.0</span></a></code></pre></div>
<p>where <code>length'</code> refers to <code>length</code> in <code>Dimensions.ValueLevel</code>.</p>
<p>The reasons for not allowing this “raw” way of creating the value is to maintain the invariant of having the same value-level and type-level dimension. With the <code>#</code> function, the are <em>forced</em> by it to be the same. The following try to work around it is not possible.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ot">myWeird ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">myWeird <span class="fu">=</span> <span class="fl">10.0</span> <span class="fu">#</span> time</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="fu">*</span> <span class="dt">Couldn&#39;t</span> match <span class="kw">type</span> &#39;<span class="dt">Numeric.NumType.DK.Integers.Zero</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                 with &#39;<span class="dt">Numeric.NumType.DK.Integers.Pos1</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">Expected</span> <span class="kw">type</span><span class="fu">:</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="dt">Actual</span> <span class="kw">type</span><span class="fu">:</span> <span class="dt">Quantity</span> <span class="dt">Time</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="fu">*</span> <span class="dt">In</span> the expression<span class="fu">:</span> <span class="fl">10.0</span> <span class="fu">#</span> time</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  <span class="dt">In</span> an equation for <span class="ot">`myWeird&#39;: myWeird = 10.0 # time</span></a></code></pre></div>
<h2 id="custom-values-and-types">Custom values and types</h2>
<p>Creating values of a dimensions <em>not</em> exported is also possible. Let’s take energy as an example.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1">energy <span class="fu">=</span> force <span class="fu">*#</span> length</a></code></pre></div>
<p><code>energy</code> can now be used just as <code>length</code> and so on.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1">energyToBoilMyGlassOfWater <span class="fu">=</span> <span class="dv">12</span> <span class="fu">#</span> energy</a></code></pre></div>
<p>In order to write explicit type signatures, we can do like this</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">type</span> <span class="dt">Velocity</span> <span class="fu">=</span> <span class="dt">Length</span> <span class="ot">`Div`</span> <span class="dt">Time</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">type</span> <span class="dt">Acceleration</span> <span class="fu">=</span> <span class="dt">Velocity</span> <span class="ot">`Div`</span> <span class="dt">Time</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">type</span> <span class="dt">Force</span> <span class="fu">=</span> <span class="dt">Acceleration</span> <span class="ot">`Mul`</span> <span class="dt">Mass</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">type</span> <span class="dt">Energy</span> <span class="fu">=</span> <span class="dt">Force</span> <span class="ot">`Mul`</span> <span class="dt">Length</span></a></code></pre></div>
<p>Note we had to introduce some helper types since, unlike the pre-made <code>Quantity</code> values, not as many were created for types.</p>
<p>Now <code>energy</code> can be defined and used like</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="ot">energy ::</span> <span class="dt">Quantity</span> <span class="dt">Energy</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">energy <span class="fu">=</span> force <span class="fu">*#</span> length</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="ot">energyToBoilMyGlassOfWater ::</span> <span class="dt">Quantity</span> <span class="dt">Energy</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">energyToBoilMyGlassOfWater <span class="fu">=</span> <span class="dv">12</span> <span class="fu">#</span> energy</a></code></pre></div>
<h2 id="some-functions">Some functions</h2>
<p>Let’s create a function operating on quantities. It should calculate the area of a rectangle given the lengths of its sides. The type should hence look like</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="ot">areaOfRectangle ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span> <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">                   <span class="dt">Quantity</span> (<span class="dt">Length</span> <span class="ot">`Mul`</span> <span class="dt">Length</span>) <span class="dt">Double</span></a></code></pre></div>
<p>And the actual function like</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1">areaOfRectangle width height <span class="fu">=</span> width <span class="fu">*#</span> height</a></code></pre></div>
<p>The values (<code>width</code> and <code>height</code>) can’t be pattern matched on. This is so we can maintain the invariant we keep nagging about. The side effect is that only the comparative and artithmetic operations exported by <code>Dimensions.Quantity</code> can be used.</p>
<p>To wrap up, let’s create a function to calculate the kinectic energy à la</p>
<span class="math display">\[\begin{align}
  E_k = \frac{m*v^2}{2}
\end{align}\]</span>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="ot">kinecticEnergy ::</span> <span class="dt">Quantity</span> <span class="dt">Mass</span> <span class="dt">Double</span> <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">                  <span class="dt">Quantity</span> <span class="dt">Velocity</span> <span class="dt">Double</span> <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">                  <span class="dt">Quantity</span> <span class="dt">Energy</span> <span class="dt">Double</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">kinecticEnergy m v <span class="fu">=</span> m <span class="fu">*#</span> v <span class="fu">*#</span> v <span class="fu">/#</span> two</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">    two <span class="fu">=</span> <span class="fl">2.0</span> <span class="fu">#</span> one</a></code></pre></div>

    </main>

    <footer>
      <nav>
	<span>[src: <a href="https://github.com/DSLsofMath/BScProj2018/blob/master/Physics/src/Dimensions/Usage.lhs">Dimensions/Usage.lhs</a>]</span>
        <span>Previous: <a href="../Dimensions/Testing%20of%20Quantities.html">Testing of Quantities</a></span>
        <a href="../index.html">Table of contents</a>
        <span>Next: <a href="../Newtonian%20Mechanics/Single%20particle%20mechanics.html">Single particle mechanics</a></span>
      </nav>
      © Björn Werner, Erik Sjöström, Johan Johansson, Oskar Lundström (2018), GPL
    </footer>
  </body>
</html>
