<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Learn You a Physics for Great Good!</title>
    <link rel="stylesheet" type="text/css" href="../style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  </head>

  <body>
    <header>
      <a href="../index.html"><h1>Learn You a <span class="physics">Physics</span> for Great Good!</h1></a>
      <h1>&gt;&gt;&gt; WORK IN PROGRESS &lt;&lt;&lt;</h1>
      <h2>Calculus / Syntax trees</h2>
      <nav>
	<span>[src: <a href="https://github.com/DSLsofMath/BScProj2018/blob/master/Physics/src/Calculus/SyntaxTree.lhs">Calculus/SyntaxTree.lhs</a>]</span>
        <span>Previous: <a href="../Calculus/Plotting%20graphs.html">Plotting graphs</a></span>
        <a href="../index.html">Table of contents</a>
        <span>Next: <a href="../Linear%20algebra/Vectors.html">Vectors</a></span>
      </nav>
    </header>

    <main>
      <div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">module</span> <span class="dt">Calculus.SyntaxTree</span> <span class="kw">where</span></a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">import</span>           <span class="dt">Calculus.FunExpr</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">import</span>           <span class="dt">Calculus.DifferentialCalc</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">import</span>           <span class="dt">Calculus.IntegralCalc</span></a></code></pre></div>
<p>A fun and useful way to visualize expressions is to model them as trees. In our case we want to model <span class="math inline">\(FunExpr\)</span> where the nodes and leaves will be our constructors.</p>
<p>In order to do this will import two packages, one for constructing trees and one for pretty printing them.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">import</span>           <span class="dt">Data.Tree</span>         <span class="kw">as</span> <span class="dt">T</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">import</span>           <span class="dt">Data.Tree.Pretty</span>  <span class="kw">as</span> <span class="dt">P</span></a></code></pre></div>
<p>Now we can construct the function that takes a FunExpr and builds a tree from it. Every node is a string representation of the constructor and a list of its sub trees (branches).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ot">makeTree ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">Tree</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">makeTree (e1 <span class="fu">:+</span> e2)  <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;+&quot;</span>    [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">makeTree (e1 <span class="fu">:-</span> e2)  <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;-&quot;</span>    [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">makeTree (e1 <span class="fu">:*</span> e2)  <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;*&quot;</span>    [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">makeTree (e1 <span class="fu">:/</span> e2)  <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Div&quot;</span>  [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">makeTree (e1 <span class="fu">:^</span> e2)  <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;**&quot;</span>   [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">makeTree (e1 <span class="fu">:.</span> e2)  <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;o&quot;</span>    [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">makeTree (<span class="dt">D</span> e)       <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;d/dx&quot;</span> [makeTree e]</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">makeTree (<span class="dt">Delta</span> r e) <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Δ&quot;</span>    [makeTree (<span class="dt">Const</span> r), makeTree e]</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">makeTree (<span class="dt">I</span> e)       <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;I&quot;</span>    [makeTree e]</a>
<a class="sourceLine" id="cb4-11" data-line-number="11">makeTree <span class="dt">Id</span>          <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Id&quot;</span>   []</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">makeTree <span class="dt">Exp</span>         <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Exp&quot;</span>  []</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">makeTree <span class="dt">Log</span>         <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Log&quot;</span>  []</a>
<a class="sourceLine" id="cb4-14" data-line-number="14">makeTree <span class="dt">Sin</span>         <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Sin&quot;</span>  []</a>
<a class="sourceLine" id="cb4-15" data-line-number="15">makeTree <span class="dt">Cos</span>         <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Cos&quot;</span>  []</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">makeTree <span class="dt">Asin</span>        <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Asin&quot;</span> []</a>
<a class="sourceLine" id="cb4-17" data-line-number="17">makeTree <span class="dt">Acos</span>        <span class="fu">=</span> <span class="dt">Node</span> <span class="st">&quot;Acos&quot;</span> []</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">makeTree (<span class="dt">Const</span> num) <span class="fu">=</span> <span class="dt">Node</span> (show num) [] <span class="co">--(show (floor num)) [] -- | Note the use of floor</span></a></code></pre></div>
<p>Now we construct trees from our expressions but we still need to print them out. For this we’ll use the function <code>drawVerticalTree</code> which does exactly what its name suggests. We can then construct a function to draw expressions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ot">printExpr ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">printExpr <span class="fu">=</span> putStrLn <span class="fu">.</span> drawVerticalTree <span class="fu">.</span> makeTree</a></code></pre></div>
<p>Now let’s construct a mildly complicated expression</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1">e <span class="fu">=</span> <span class="dt">Delta</span> <span class="dv">3</span> (<span class="dt">Delta</span> (negate <span class="dv">5</span>) (<span class="dt">I</span> <span class="dt">Acos</span>) <span class="fu">:.</span> (<span class="dt">Acos</span> <span class="fu">:*</span> <span class="dt">Exp</span>))</a></code></pre></div>
<p>And print it out.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1">ghci <span class="fu">&gt;</span> printExpr e</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">          Δ</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">          <span class="fu">|</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="co">-----------</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"> <span class="fu">/</span>           \</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"> <span class="dv">3</span>           o</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">             <span class="fu">|</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">        <span class="co">----------</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">        <span class="fu">/</span>          \</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">        Δ          <span class="fu">*</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">        <span class="fu">|</span>          <span class="fu">|</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">       <span class="co">----       -----</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">      <span class="fu">/</span>    \     <span class="fu">/</span>     \</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">     <span class="fu">-</span><span class="dv">5</span>    <span class="dt">I</span>   <span class="dt">Acos</span>   <span class="dt">Exp</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">           <span class="fu">|</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">          <span class="dt">Acos</span></a></code></pre></div>
<p>Pretty prints the steps taken when canonifying an expression</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ot">prettyCan ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">prettyCan e <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="kw">let</span> t  <span class="fu">=</span> makeTree e</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">      e&#39; <span class="fu">=</span> canonify e</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">      t&#39; <span class="fu">=</span> makeTree e&#39;</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">    <span class="kw">in</span> <span class="kw">if</span> t <span class="fu">==</span> t&#39; <span class="kw">then</span> putStrLn <span class="fu">$</span> drawVerticalTree t</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">                  <span class="kw">else</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8">                      putStrLn <span class="fu">$</span> drawVerticalTree t</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">                      prettyCan e&#39;</a></code></pre></div>
<p>Pretty prints syntactic checking of equality</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="ot">prettyEqual ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">prettyEqual e1 e2 <span class="fu">=</span> <span class="kw">if</span> e1 <span class="fu">==</span> e2 <span class="kw">then</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="kw">do</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    putStrLn <span class="st">&quot;It&#39;s equal!&quot;</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    putStrLn <span class="fu">$</span> drawVerticalForest [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    return <span class="dt">True</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7">  <span class="kw">else</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    putStrLn <span class="st">&quot;Not equal -&gt; Simplifying&quot;</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    putStrLn <span class="fu">$</span> drawVerticalForest [makeTree e1, makeTree e2]</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">    <span class="kw">let</span> c1 <span class="fu">=</span> canonify e1</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">        c2 <span class="fu">=</span> canonify e2</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">      <span class="kw">in</span> <span class="kw">if</span> c1 <span class="fu">==</span> e1 <span class="fu">&amp;&amp;</span> c2 <span class="fu">==</span> e2 <span class="kw">then</span> putStrLn <span class="st">&quot;Can&#39;t simplify no more&quot;</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">                                        <span class="fu">&gt;&gt;</span> return <span class="dt">False</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">                                 <span class="kw">else</span> prettyEqual c1 c2</a></code></pre></div>
<p>Syntactic checking of equality</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="ot">equal ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">equal e1 e2 <span class="fu">=</span> (e1 <span class="fu">==</span> e2) <span class="fu">||</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                 (<span class="kw">let</span> c1 <span class="fu">=</span> canonify e1</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                      c2 <span class="fu">=</span> canonify e2</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                    <span class="kw">in</span> (not (e1 <span class="fu">==</span> c1 <span class="fu">&amp;&amp;</span> c2 <span class="fu">==</span> e2) <span class="fu">&amp;&amp;</span> equal c1 c2))</a></code></pre></div>
<p>Parse an expression as a Tree of Strings</p>
<p>Of course this is all bit too verbose, but I’m keeping it that way until every case is covered, Calculus is a bit of a black box for me right now</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="ot">canonify ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span></a></code></pre></div>
<p>Addition</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1">canonify (e <span class="fu">:+</span> <span class="dt">Const</span> <span class="dv">0</span>)       <span class="fu">=</span> canonify e</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">canonify (<span class="dt">Const</span> <span class="dv">0</span> <span class="fu">:+</span> e)       <span class="fu">=</span> canonify e</a>
<a class="sourceLine" id="cb12-3" data-line-number="3">canonify (<span class="dt">Const</span> x <span class="fu">:+</span> <span class="dt">Const</span> y) <span class="fu">=</span> <span class="dt">Const</span> (x <span class="fu">+</span> y)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">canonify (e1 <span class="fu">:+</span> e2)           <span class="fu">=</span> canonify e1 <span class="fu">:+</span> canonify e2</a></code></pre></div>
<p>Subtraction</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1">canonify (e <span class="fu">:-</span> <span class="dt">Const</span> <span class="dv">0</span>)       <span class="fu">=</span> canonify e</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">canonify (<span class="dt">Const</span> a <span class="fu">:-</span> <span class="dt">Const</span> b) <span class="fu">=</span> <span class="dt">Const</span> (a <span class="fu">-</span> b)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">canonify (e1 <span class="fu">:-</span> e2)           <span class="fu">=</span> canonify e1 <span class="fu">:-</span> canonify e2</a></code></pre></div>
<p>Multiplication</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1">canonify (_ <span class="fu">:*</span> <span class="dt">Const</span> <span class="dv">0</span>)       <span class="fu">=</span> <span class="dt">Const</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">canonify (<span class="dt">Const</span> <span class="dv">0</span> <span class="fu">:*</span> _)       <span class="fu">=</span> <span class="dt">Const</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">canonify (e <span class="fu">:*</span> <span class="dt">Const</span> <span class="dv">1</span>)       <span class="fu">=</span> canonify e</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">canonify (<span class="dt">Const</span> <span class="dv">1</span> <span class="fu">:*</span> e)       <span class="fu">=</span> canonify e</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">canonify (<span class="dt">Const</span> a <span class="fu">:*</span> <span class="dt">Const</span> b) <span class="fu">=</span> <span class="dt">Const</span> (a <span class="fu">*</span> b)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">canonify (e1 <span class="fu">:*</span> e2)           <span class="fu">=</span> canonify e1 <span class="fu">:*</span> canonify e2</a></code></pre></div>
<p>Division</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1">canonify (<span class="dt">Const</span> a <span class="fu">:/</span> <span class="dt">Const</span> b) <span class="fu">=</span> <span class="dt">Const</span> (a <span class="fu">/</span> b)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">canonify (e1 <span class="fu">:/</span> e2)           <span class="fu">=</span> canonify e1 <span class="fu">:/</span> canonify e2</a></code></pre></div>
<p>Delta</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1">canonify (<span class="dt">Delta</span> r e)            <span class="fu">=</span> <span class="dt">Delta</span> r <span class="fu">$</span> canonify e</a></code></pre></div>
<p>Derivatives</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1">canonify (<span class="dt">D</span> e)                <span class="fu">=</span> derive e</a></code></pre></div>
<p>Composition</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1">canonify (e1 <span class="fu">:.</span> e2)           <span class="fu">=</span> canonify e1 <span class="fu">:.</span> canonify e2</a></code></pre></div>
<p>Catch all</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb19-1" data-line-number="1">canonify e                    <span class="fu">=</span> e</a></code></pre></div>
<h2 id="proofs">“Proofs”</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="ot">syntacticProofOfComForMultiplication ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">syntacticProofOfComForMultiplication e1 e2 <span class="fu">=</span> prettyEqual (e1 <span class="fu">:*</span> e2) (e2 <span class="fu">:*</span> e1)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="ot">syntacticProofOfAssocForMultiplication ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">syntacticProofOfAssocForMultiplication e1 e2 e3 <span class="fu">=</span> prettyEqual (e1 <span class="fu">:*</span> (e2 <span class="fu">:*</span> e3))</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">                                                              ((e1 <span class="fu">:*</span> e2) <span class="fu">:*</span> e3)</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="ot">syntacticProofOfDistForMultiplication ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">syntacticProofOfDistForMultiplication e1 e2 e3 <span class="fu">=</span> prettyEqual (e1 <span class="fu">:*</span> (e2 <span class="fu">:+</span> e3))</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                                                              ((e1 <span class="fu">:*</span> e2) <span class="fu">:+</span> (e1 <span class="fu">:*</span> e3))</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co">{- syntacticProofOfIdentityForMultiplication :: FunExpr -&gt; IO Bool -}</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="co">{- syntacticProofOfIdentityForMultiplication e = -}</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="co">{-   putStrLn &quot;[*] Checking right identity&quot; &gt;&gt; -}</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="co">{-     prettyEqual e (1 :* e) &gt;&gt; -}</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="co">{-       putStrLn &quot;[*] Checking left identity&quot; &gt;&gt; -}</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="co">{-         prettyEqual e (e :* 1) -}</span></a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">{- syntacticProofOfPropertyOf0ForMultiplication :: FunExpr -&gt; IO Bool -}</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">{- syntacticProofOfPropertyOf0ForMultiplication e = -}</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">{-   prettyEqual (e :* 0) 0 -}</span></a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co">-- | Fails since default implementation of negate x for Num is 0 - x</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2"><span class="co">{- syntacticProofOfPropertyOfNegationForMultiplication :: FunExpr -&gt; IO Bool -}</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="co">{- syntacticProofOfPropertyOfNegationForMultiplication e = -}</span></a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="co">{-   prettyEqual (Const (-1) :* e)  (negate e) -}</span></a></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="ot">syntacticProofOfComForAddition ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">syntacticProofOfComForAddition e1 e2 <span class="fu">=</span> prettyEqual (e1 <span class="fu">:+</span> e2) (e2 <span class="fu">:+</span> e1)</a></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="ot">syntacticProofOfAssocForAddition ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">syntacticProofOfAssocForAddition e1 e2 e3 <span class="fu">=</span> prettyEqual (e1 <span class="fu">:+</span> (e2 <span class="fu">:+</span> e3))</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">                                                        ((e1 <span class="fu">:+</span> e2) <span class="fu">:+</span> e3)</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="ot">test ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2">test b c <span class="fu">=</span> prettyEqual b (a <span class="fu">:*</span> c)</a>
<a class="sourceLine" id="cb28-3" data-line-number="3">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4">    a <span class="fu">=</span> b <span class="fu">:/</span> c</a></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="ot">syntacticProofOfIdentityForAddition ::</span> <span class="dt">FunExpr</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2">syntacticProofOfIdentityForAddition e <span class="fu">=</span> putStrLn <span class="st">&quot;[*] Checking right identity&quot;</span> <span class="fu">&gt;&gt;</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3">  prettyEqual e (<span class="dv">0</span> <span class="fu">:+</span> e) <span class="fu">&gt;&gt;</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">    putStrLn <span class="st">&quot;[*] Checking left identity&quot;</span> <span class="fu">&gt;&gt;</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">      prettyEqual e (e <span class="fu">:+</span> <span class="dv">0</span>)</a></code></pre></div>
<p>Dummy expressions</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb30-1" data-line-number="1">e1 <span class="fu">=</span> <span class="dt">Const</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2">e2 <span class="fu">=</span> <span class="dt">Const</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3">e3 <span class="fu">=</span> <span class="dt">Const</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4">e4 <span class="fu">=</span> (<span class="dt">Const</span> <span class="dv">1</span> <span class="fu">:+</span> <span class="dt">Const</span> <span class="dv">2</span>) <span class="fu">:*</span> (<span class="dt">Const</span> <span class="dv">3</span> <span class="fu">:+</span> <span class="dt">Const</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">e5 <span class="fu">=</span> (<span class="dt">Const</span> <span class="dv">1</span> <span class="fu">:+</span> <span class="dt">Const</span> <span class="dv">2</span>) <span class="fu">:*</span> (<span class="dt">Const</span> <span class="dv">4</span> <span class="fu">:+</span> <span class="dt">Const</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb30-6" data-line-number="6">e6 <span class="fu">=</span> <span class="dt">Const</span> <span class="dv">2</span> <span class="fu">:+</span> <span class="dt">Const</span> <span class="dv">3</span> <span class="fu">:*</span> <span class="dt">Const</span> <span class="dv">8</span> <span class="fu">:*</span> <span class="dt">Const</span> <span class="dv">19</span></a></code></pre></div>

    </main>

    <footer>
      <nav>
	<span>[src: <a href="https://github.com/DSLsofMath/BScProj2018/blob/master/Physics/src/Calculus/SyntaxTree.lhs">Calculus/SyntaxTree.lhs</a>]</span>
        <span>Previous: <a href="../Calculus/Plotting%20graphs.html">Plotting graphs</a></span>
        <a href="../index.html">Table of contents</a>
        <span>Next: <a href="../Linear%20algebra/Vectors.html">Vectors</a></span>
      </nav>
      © Kandidatboisen (2018), GPL
    </footer>
  </body>
</html>
