<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Learn You a Physics for Great Good!</title>
    <link rel="stylesheet" type="text/css" href="../style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  </head>

  <body>
    <header>
      <a href="../index.html"><h1>Learn You a <span class="physics">Physics</span> for Great Good!</h1></a>
      <h1>&gt;&gt;&gt; WORK IN PROGRESS &lt;&lt;&lt;</h1>
      <h2>Dimensions / Usage</h2>
      <nav>
	<span>[src: <a href="https://github.com/DSLsofMath/BScProj2018/blob/master/Physics/src/Dimensions/Usage.lhs">Dimensions/Usage.lhs</a>]</span>
        <span>Previous: <a href="../Dimensions/Testing of Quantity.html">Testing of Quantity</a></span>
        <a href="../index.html">Table of contents</a>
        <span>Next: <a href="../Examples/Gungbräda.html">Gungbräda</a></span>
      </nav>
    </header>

    <main>
      <h1 id="usage">Usage</h1>
<p>In this module we'll show how to use value-level dimensions, type-level dimensions and <code>Quantity</code> in an &quot;actual&quot; progam.</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="ot">{-# LANGUAGE TypeOperators #-}</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="kw">module</span> <span class="dt">Dimensions.Usage</span>
(
)
<span class="kw">where</span></code></pre></div>
<p>Let's first import the things we have created.</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="kw">import </span><span class="dt">Dimensions.TypeLevel</span>
<span class="kw">import </span><span class="dt">Dimensions.Quantity</span>
<span class="kw">import </span><span class="dt">Prelude</span> <span class="kw">hiding</span> (length)</code></pre></div>
<p>We don't need to import <code>Dimensions.ValueLevel</code> since all its features are available by using the <code>Quantity</code> data type. The same thing could be said about <code>Dimensions.TypeLevel</code>. So why do we import it? It's so we can write explicit type signatures, the trick of trade in Haskell progamming.</p>
<h2 id="values-and-types">Values and types</h2>
<p>Let's create a length, time and mass, in the way hinted in the previous chapter.</p>
<p>TODO: Av okända skäl så blir de nedanstående av typ <code>Integer</code> om ej en decimal tas med. Man vill nog ha dom som <code>Double</code>. Idealt skulle de ha typ <code>(Num v) =&gt; v</code> men jag har inte fått till det så bra.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">myLength <span class="fu">=</span> <span class="fl">10.0</span> <span class="fu">#</span> length
myTime   <span class="fu">=</span> <span class="fl">20.0</span> <span class="fu">#</span> time
myMass   <span class="fu">=</span> <span class="fl">30.0</span> <span class="fu">#</span> mass</code></pre></div>
<p>Okay, let's check out their type and value in GHCi.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">ghci<span class="fu">&gt;</span> myLength
<span class="fl">10.0</span> m
ghci<span class="fu">&gt;</span> <span class="fu">:</span>t myLength
<span class="ot">myLength ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span>
ghci<span class="fu">&gt;</span> myTime
<span class="fl">20.0</span> s
ghci<span class="fu">&gt;</span> <span class="fu">:</span>t myTime
<span class="ot">myTime ::</span> <span class="dt">Quantity</span> <span class="dt">Time</span> <span class="dt">Double</span></code></pre></div>
<p>The pretty printing works thanks to dimensions on <em>value-level</em> and the Haskell-types thanks to the <em>type-level</em> dimensions. Recall that the value-level dimensions just is a pretty simple &quot;average&quot; data type.</p>
<p>Let's write some type signatures on those values (of type <code>Quantity</code>).</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="ot">myLength ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span>
myLength <span class="fu">=</span> <span class="fl">10.0</span> <span class="fu">#</span> length
<span class="ot">myTime ::</span> <span class="dt">Quantity</span> <span class="dt">Time</span> <span class="dt">Double</span>
myTime <span class="fu">=</span> <span class="fl">20.0</span> <span class="fu">#</span> time
<span class="ot">myMass ::</span> <span class="dt">Quantity</span> <span class="dt">Mass</span> <span class="dt">Double</span>
myMass <span class="fu">=</span> <span class="fl">30.0</span> <span class="fu">#</span> mass</code></pre></div>
<p>Neat! <code>Length</code>, <code>Time</code> and <code>Mass</code> are type-level dimensions. Therefore, <code>Length</code> <em>is</em> a type, just like <code>String</code> is a type.</p>
<p>Remember that the sugary style of writing <code>10.0 # length</code> is a shorthand for doing</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">myLength ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span>
myLength <span class="fu">=</span> <span class="dt">Quantity</span> length&#39; <span class="fl">10.0</span></code></pre></div>
<p>where <code>length'</code> refers to <code>length</code> in <code>Dimensions.ValueLevel</code>.</p>
<p>The reasons for not allowing this &quot;raw&quot; way of creating the value is to maintain the invariant of having the same value-level and type-level dimension. With the <code>#</code> function, the are <em>forced</em> by it to be the same. The following try to work around it is not possible.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">myWeird ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span>
myWeird <span class="fu">=</span> <span class="fl">10.0</span> <span class="fu">#</span> time</code></pre></div>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="fu">*</span> <span class="dt">Couldn&#39;t</span> match <span class="kw">type</span> <span class="ch">&#39;Numeric.NumType.DK.Integers.Zero</span>
                 with <span class="ch">&#39;Numeric.NumType.DK.Integers.Pos1</span>
  <span class="dt">Expected</span> <span class="kw">type</span><span class="fu">:</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span>
    <span class="dt">Actual</span> <span class="kw">type</span><span class="fu">:</span> <span class="dt">Quantity</span> <span class="dt">Time</span> <span class="dt">Double</span>
<span class="fu">*</span> <span class="dt">In</span> the expression<span class="fu">:</span> <span class="fl">10.0</span> <span class="fu">#</span> time
  <span class="dt">In</span> an equation for <span class="ot">`myWeird&#39;: myWeird = 10.0 # time</span></code></pre></div>
<h2 id="custom-values-and-types">Custom values and types</h2>
<p>Creating values of a dimensions <em>not</em> exported is also possible. Let's take energy as an example.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">energy <span class="fu">=</span> force <span class="fu">*#</span> length</code></pre></div>
<p><code>energy</code> can now be used just as <code>length</code> and so on.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">energyToBoilMyGlassOfWater <span class="fu">=</span> <span class="dv">12</span> <span class="fu">#</span> energy</code></pre></div>
<p>In order to write explicit type signatures, we can do like this</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="kw">type</span> <span class="dt">Velocity</span> <span class="fu">=</span> <span class="dt">Length</span> <span class="ot">`Div`</span> <span class="dt">Time</span>
<span class="kw">type</span> <span class="dt">Acceleration</span> <span class="fu">=</span> <span class="dt">Velocity</span> <span class="ot">`Div`</span> <span class="dt">Time</span>
<span class="kw">type</span> <span class="dt">Force</span> <span class="fu">=</span> <span class="dt">Acceleration</span> <span class="ot">`Mul`</span> <span class="dt">Mass</span>
<span class="kw">type</span> <span class="dt">Energy</span> <span class="fu">=</span> <span class="dt">Force</span> <span class="ot">`Mul`</span> <span class="dt">Length</span></code></pre></div>
<p>Note we had to introduce some helper types since, unlike the pre-made <code>Quantity</code> values, not as many were created for types.</p>
<p>Now <code>energy</code> can be defined and used like</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="ot">energy ::</span> <span class="dt">Quantity</span> <span class="dt">Energy</span> <span class="dt">Double</span>
energy <span class="fu">=</span> force <span class="fu">*#</span> length
<span class="ot">energyToBoilMyGlassOfWater ::</span> <span class="dt">Quantity</span> <span class="dt">Energy</span> <span class="dt">Double</span>
energyToBoilMyGlassOfWater <span class="fu">=</span> <span class="dv">12</span> <span class="fu">#</span> energy</code></pre></div>
<h2 id="some-functions">Some functions</h2>
<p>Let's create a function operating on quantities. It should calculate the area of a rectangle given the lengths of its sides. The type should hence look like</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="ot">areaOfRectangle ::</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span> <span class="ot">-&gt;</span> <span class="dt">Quantity</span> <span class="dt">Length</span> <span class="dt">Double</span> <span class="ot">-&gt;</span>
                   <span class="dt">Quantity</span> (<span class="dt">Length</span> <span class="ot">`Mul`</span> <span class="dt">Length</span>) <span class="dt">Double</span></code></pre></div>
<p>And the actual function like</p>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell">areaOfRectangle width height <span class="fu">=</span> width <span class="fu">*#</span> height</code></pre></div>
<p>The values (<code>width</code> and <code>height</code>) can't be pattern matched on. This is so we can maintain the invariant we keep nagging about. The side effect is that only the comparative and artithmetic operations exported by <code>Dimensions.Quantity</code> can be used.</p>
<p>To wrap up, let's create a function to calculate the kinectic energy à la</p>
<span class="math display">\[\begin{align}
  E_k = \frac{m*v^2}{2}
\end{align}\]</span>
<div class="sourceCode"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><span class="ot">kinecticEnergy ::</span> <span class="dt">Quantity</span> <span class="dt">Mass</span> <span class="dt">Double</span> <span class="ot">-&gt;</span>
                  <span class="dt">Quantity</span> <span class="dt">Velocity</span> <span class="dt">Double</span> <span class="ot">-&gt;</span>
                  <span class="dt">Quantity</span> <span class="dt">Energy</span> <span class="dt">Double</span>
kinecticEnergy m v <span class="fu">=</span> m <span class="fu">*#</span> v <span class="fu">*#</span> v <span class="fu">/#</span> two
  <span class="kw">where</span>
    two <span class="fu">=</span> <span class="fl">2.0</span> <span class="fu">#</span> one</code></pre></div>

    </main>

    <footer>
      <nav>
	<span>[src: <a href="https://github.com/DSLsofMath/BScProj2018/blob/master/Physics/src/Dimensions/Usage.lhs">Dimensions/Usage.lhs</a>]</span>
        <span>Previous: <a href="../Dimensions/Testing of Quantity.html">Testing of Quantity</a></span>
        <a href="../index.html">Table of contents</a>
        <span>Next: <a href="../Examples/Gungbräda.html">Gungbräda</a></span>
      </nav>
      © Kandidatboisen (2018), GPL
    </footer>
  </body>
</html>
